@page "/Projects"

<PageTitle>My projects</PageTitle>

<Container>
    <Row>
        <Column>
            <Heading Size="HeadingSize.Is4">My projects</Heading>
        </Column>
    </Row>

    <Row Class="mt-3">

        @foreach (var project in UserProjects)
        {
            <Column ColumnSize="ColumnSize.Is12.OnTablet.Is12.OnMobile.Is4.OnDesktop.Is3.OnWidescreen.Is3.OnFullHD" Class="mb-4">
                <Card Height="Height.Is100"
                      Style="background-image: url('images/defatult_background.jpg'); 
                          color: white;">
                    <CardBody>
                        <CardTitle Size="4">
                            @project.Title
                        </CardTitle>
                    </CardBody>
                </Card>
            </Column>
        }

        @if (!UserProjects.Any())
        {
            <Column>
                <Paragraph>No projects found.</Paragraph>
            </Column>
        }

        <Column ColumnSize="ColumnSize.Is12.OnTablet.Is12.OnMobile.Is4.OnDesktop.Is3.OnWidescreen.Is3.OnFullHD" Class="mb-4">
            <Card Background="Background.Light" Height="Height.Is100" @onclick="@ShowModal" Style="cursor: pointer">
                <CardBody Class="card-body">
                    <CardTitle Size="4">
                        Create new project
                        <Icon Name="IconName.Add"></Icon>
                    </CardTitle>
                </CardBody>
            </Card>
        </Column>
    </Row>

    <Modal @ref="_modalRef">
        <ModalContent Centered>
            <ModalHeader>
                <ModalTitle>Create New Project</ModalTitle>
                <CloseButton/>
            </ModalHeader>
            <ModalBody>
                <Validations @ref="fluentValidation" Mode="ValidationMode.Manual" Model="_newProject" HandlerType="typeof(FluentValidationHandler)">
                    <Field>
                        <Label>Project Title</Label>
                        <Validation>
                            <TextEdit @bind-Text="_newProject.Title"/>
                        </Validation>
                    </Field>
                    <Field>
                        <Label>Description</Label>
                        <Validation>
                            <TextEdit @bind-Text="_newProject.Description"/>
                        </Validation>
                    </Field>
                </Validations>
            </ModalBody>
            <ModalFooter>
                <Button Color="Color.Secondary"
                        Clicked="@HideModal">
                    Cancel
                </Button>
                <Button Color="Color.Primary"
                        Clicked="@CreateProject">
                    Create new project
                </Button>
            </ModalFooter>
        </ModalContent>
    </Modal>
</Container>